
【　ソフトウェア名称　】　万能文化 SmartScroll Plug-in
【　バージョン情報　　】　1.0.0.0
【　　　動作環境　　　】　Windows XP, 2000, Me, 98
			　(※注:NT4以下のNT系では動作しません。)
　　　　　　　　　　　　　WACOM社製SmartScroll 1.10
【　　　　著作　　　　】　COPYRIGHT(C) 2003 ♪不思議うさぎ

●最近の更新

　v1.0.0.0	#2003-07-05＠
		出来上がったので公開してみる。^^;

●プラグインの説明

　このソフトはSmartScroll専用プラグインです。

　特化プラグインの存在しない多くの一般的なアプリに対応するためのプラグインです。
　（スーパーデファルトプラグインとでもお呼び下さい。(苦笑)）

　　万能文化プラグインは特化プラグインの無いあらゆるアプリケーションに柔軟に対応
　可能です。(特化プラグインがあっても万能文化プラグイン使ってもいいんだけど。^^;)

　機能は・・・設定ファイルさえメモ帖などのテキストエディタで書けば一般的なキース
トローク動作やスクロールなどはわりとなんでもこなせます。

●配布ファイル構成

　BANNOUBUNKA.ssp	------ プラグイン
　BANNOUBUNKA.INI	------ 万能文化設定ファイル(の、サンプル)

　Readme.txt		------ 今読んでいるファイル

●インストールとアンインストールの方法(SS)

　「SmartScrollヘルプ」の「メンテナンスについて」＞「プラグインをアップデートする」をご覧下さい。
　（SmartScrollドライバをウィドウ表示状態にして”SmartScroll「？」「＿」”の「？」を押しましょう。）

　さ・ら・に、プラグイン本体のインストールの他に、万能文化設定ファイルをスマートスクロールの、
インストールディレクトリのプラグインディレクトリ(標準的にはC:\Program files\WACOM\SmartScroll\plugins)
にコピーしといて下さい。

　※なければ勝手に作るような親切丁寧ユーザーフレンドリーな機能は作者の怠慢により未実装です。(苦笑)

●万能文化設定ファイルの書き方

　　以下、一応添付のサンプル見ながら読んで下さい。・・・もしかしたら以下の説明読むよりも
　BANNNOUBUNKA.INI見ただけでなんとなく設定の仕方が解るようであれば以下は見ないでもいいか
　もしれません。(説明が下手なせいか小難しくて長くなってしまいましたので。＞＜)

　※(BANNOUBUNKA.INIはWindows標準INI形式に準拠なのでメモ帖などのテキストエディタだけで編集できます。)

　<1>セクション[BANNOUBUNKA]について

　　1-1.Editorキー

	　このプラグインには一般的なSSPのようなダイアログベースの設定GUIが用意されていません。
	そういうわけで、"設定=万能文化設定ファイルの編集"になるわけですが、編集に使うテキスト
	エディターを指定します。通常はNotepad.exeを指定しておけば問題ありませんが、INIファイル
	の編集に特化された機能を持ったテキストエディター(GreenPad等*1)をお使いの場合は指定する
	と便利です。

	ex)	Editor="C:\Windows\notepad.exe"

	(*1)　GreenPad　K.INABA氏のフリーソフト
		http://www.kmonos.net/ ⇒ 「がらくた」から入手可能

　　1-2.DecisionModeキー

	　このプラグインは一般の多くのSSPのようにクラスネームによるアプリケーションの判定機能
	と、実行中のアプリケーションの実行ファイルの名前による判定機能があります。また、この
	項目では万能文化設定ファイルに設定項目が存在しないアプリケーションについて、判定用の
	クラスネームと実行ファイル名を記録する機能、デファルトプラグインとして動作する機能が
	あり、それらをこのキーで指定することができます。
	　以下の値の和を指定します。

	1 クラスネーム判定を行う
	2 実行ファイル名判定を行う
	4 設定項目の存在しないアプリは設定項目作成用のクラスネームと実行ファイル名の記録を取る
	8 デファルトプラグインとして動作する

	　以下の例では1+2+8=11、つまりクラス判定ファイル名判定を行いデファルトプラグインとしても動作します。

	ex)	DecisionMode=11

	　また、4を指定した場合の"記録"ですが、万能文化設定ファイル内の[BANNOUBUNKA-UNKNOWN-LOG]
	というセクションに、(クラスネーム)=(実行ファイル名)の形で記録します。以下記録される例。

	ex)	[BANNOUBUNKA-UNKNOWN-LOG]
	ex)	Afx:400000:8:10013:0:d89045d=Sleipnir.exe
	ex)	Afx:400000:8:10013:0:7202e7=MSDEV.EXE
	ex)	SMARTSCROLL=smascrl.exe
	ex)	_macr_dreamweaver_frame_window_=Dreamweaver.exe
	ex)	Afx:400000:b:0:6:834a01eb=Dreamweaver.exe
	ex)	Afx:400000:8:10013:0:3009a7=XGworks.exe
	ex)	Notepad=notepad.exe

	　さて、ここでアドバイスを１つ。通常はクラスネームで判定項目を作ればよいのですが、上記し
	た例でも”Afx:うにゃうにゃうにゃうにゃ=もへへのへ”というようにクラスがAfxで始まっていて
	アプリの名前っぽくないのがあります。なんでこーなるかはまあいいとして(*1)、この手のアプリ
	は困ったことに動かすたびにクラス名が変わります。上記の例では「SMARTSCROLL」や「Notepad」
	(スマートスクロールの常駐部分とメモ帖ですね^^;)は、クラス名がバシっと出てますが、Afxで
	始まっているアプリも結構あります。右辺の実行ファイル名を見ればだいたいどれが何のことか
	解りますが、
	　「Sleipnir.exe」はフリーソフトでタブブラウザのSleipnir(*2)、
	　「MSDEV.EXE」はいわゆるMicrosoftのVisualStudio、
	　「Dreamwaver.exe」はMacromedia(*3)のHTMLエディターであるDreamWaver、
	　「XGWorks.exe」はYAMAHAのシーケンスソフトXGWorks(*4)、
	と、まあ一般的なアプリを例にしたつもりですが、いかにもスマートスクロールを使いたくなる
	ようなクリエイター御用達なツールがことごとく「Afxほにゃほにゃ・・・」の仲間ですね。TT
	先に言ったようにこれらはクラス名判定が事実上使用できませんので、この手のアプリちゃんは
	実行ファイル名で設定を作成し、DecisionModeに2も設定して快適に万能文化プラグインをお使い下さい。

	※クラスネーム：アプリケーションに固有のお名前とでも思えばよいです。ちゃんと知りたい人は
	　　　　　　　　ウィンドウズプログラミングの本でも読んで下さい。このSSP使うだけならそん
			な詳しい知識は要りませんが、一応拘るアナタの為に余計な一言をば。

	(*1)：いわゆるMFCアプリでウィンドウ作成時にクラスを特別に指定してやらなかった場合にこーな
	　　　ります。困ったチャンなことにこの手のアプリは動かすごとにこのクラス名が変わります。
	　　　・・・MFCが何か、とか興味がある人はウィンドウズプログラミングの本で目次なんかでMFCに
	　　　ついて触れてそうなのを参照してください。このSSPを使うだけなら(以下略)。

	(*2)：Sleipnir　Yasuyuki Kashiwagi氏のフリーソフト
		http://www20.pos.to/~sleipnir/ ここで入手可能。

	(*3)：Macromedia FLASH、FireWorks、DreamWaver、Director、Fleehandなどで絵描きやWEB屋にはおなじみの会社
		http://www.macromedia.com/jp/

	(*4)：XGWorks　YAMAHAのトーンジェネレーター(いわゆるMIDI音源)を使う人はおなじみのソフト
		http://www.yamaha.co.jp/xg/

　　1-2.セクション[BANNOUBUNKA]内のSSPName、SSPBT、SSPB?(?=0,1,2,3,4,5,6,7)、SSPS?(?=U,D,L,R)、SSPZ?(?=F,B,C)

	　これらのキーの設定については以下の「アプリごとの設定」で詳しく解説していますが、
	このBANNNOUBUNKAセクションではデファルトプラグインとして使用する場合の設定となります。

　<2>アプリごとの設定をする

　　　先ず、どうにかして対応設定を作りたいアプリの「クラスネーム」か「実行ファイル名」を見つけます。
　　(先に説明したDecisionModeで4を含んだ値を設定すればこのプラグインだけで調べられます。)
　　　よく解らなければ「クラスネームってなんなんだー」と精神すり減らさずに、実行ファイル名で設定作る
　　とよいでしょう。^^;(メモ帖ならnotepad.exe、ショートカットがデスクトップにあったりするソフトの場
　　合はそのショートカットのプロパティの「リンク先」というトコでも見たら解るかもしれません。)

　　2-1.アプリケーションの「クラスネーム」または「実行ファイル名」が解ったら

	　以下のようなセクションを作ります。

	ex)	[(クラスネームまたは実行ファイル名)]

	　えー、解りづらいですね、、たとえば、メモ帖の設定を作りたい場合は、

	ex)	[Notepad]

	　と、メモ帖のクラスネームでセクションを書くか、

	ex)	[notepad.exe]

	　と、実行ファイル名でセクションを書きます。

	※なお、これだけではまだ万能文化プラグインは指定したアプリに反応しません。もう一息です。

　　2-2.アプリごとのセクションにスマートスクロールの設定を書く(ようやく本番です^^;)

　　　2-2-1.対応アプリの名前を好き勝手に解り易くつけておく(必須)

	　以下のようにSSPNameキーでアプリ用のセクションが何のプラグインとして動作するのかにお名前
	をつけて置きます。

	ex)	[Sleipnir.exe]
	ex)	SSPName=Sleipnir

	ex)	[Notepad]
	ex)	SSPName=メモ帖

	ex)	[XGWorks]
	ex)	SSPName=ヤマハヤマハヤマハのエックスジー

	　最後の例は「好きな名前つけていいです」というわけで何でもいいですよ、という例のつもりです。^^;
	一応ここで指定した名前はSmartScrollのウィンドウでプラグイン名のトコに「万能文化->メモ帖」
	といった具合で表示されます。

	　また、この項目が設定されてなければそのセクション自体を無効(=未設定)として扱いますので、
	一時的に設定を無効にしたい場合などは、

	ex)	[Notepad]
	ex)	;SSPName=メモ帖

	　と、すればこのセクションまるごと無効にしたことになります。(*1)

	(*1)INIファイルでの「;」の意味：Windows標準のINIに準拠した設定ファイル形式ではセミコロン
					から先を設定とは無関係のコメントとして認識します。
					つまり設定項目の先頭に;を書くとその行は書いてない事にな
					るわけです。

　　　2-2-2.SSPBTキー

	　ボタンを押した時にどのタイミングで設定した動作を発動するのかを指定します。

	　「ボタンを押す」という一般的な表現は細かく言うと＝「ボタンを押して」+「ボタンを離す」
	と、なるわけです。普段あまり気にしないかもしれませんがボタンが押し下げられた瞬間に反応
	するのか、ボタンが押されてから指が離されてボタンが上がるときに反応するのかでは、用途に
	よって使い勝手が大きく変わります。このタイミングを「D=Down」「U=Up」で設定できます。

	　ちなみにオフィシャルのフォトショププラグインの場合はツールなどのボタンはU判定、Shift
	などはI判定です。I判定はSSのボタンを押している間指定のキーも押しっぱなしの状態で、SSの
	ボタンを離すとキーを離した信号がでるというパターンです。ほかに、ゲーム用のプラグインな
	どではD判定(押した瞬間に所定のキーが押されてキャラクターが行動する・・・など)で動くパ
	ターンがあります。

	　万能文化設定ファイルでは9個のボタンに対してこのアップダウン判定のタイミングを指定し
	ます。設定は文字列の右側から左側へ、ボタン1、ボタン2・・・です。

		      987654321
		      ^^^^^^^^^
		      |||||||||
	ex)	SSPBT=UIIUUDDUU

	　この例では、ボタン(1,2,5,6)はUP判定、ボタン(3,4)はダウン判定、ボタン(7,8)は押している
	間中キーを押していることになるI判定に設定されます。さて、9番目のボタンは何かというと、
	ズームのボタンです。例ではズームをコチっとやった場合の判定はU判定に設定されています。

	　前述したように画像処理ソフトでCtrlやShiftなどを押したままマウスを操作するような場合に
	は、I判定を使うと便利です。が、Ctrl+AなどはUまたはD判定でよいでしょう。

　　　2-2-2.SSPB?(?=1〜8)、SSPZ?(?=C,F,B)、SSP?(?=U,D,L,R)キー

	　これらのキーはボタン1〜8、ズームのクリック(ボタン9)・前回転・後回転、スクロールの上下
	左右に対しての具体的な設定です。

	　なお、設定は仮想キーコードと呼ばれるキーを表す文字列を使います。仮想キーコードは、

	VK_A VK_B VK_C・・・
	VK_1 VK_2 VK_3・・・
	VK_F1 VK_F2 VK_F3・・・
	VK_NUMPAD1 VK_NUMPAD2・・・
	VK_SPACE VK_RETURN VK_SHIFT VK_CONTROL

	　などなど、通常はキーの名前にVK_がついたものです。但し、ちょっと注意すべき例がいくつか
	あります。

	VK_RETURN コードとしてはリターンでありVK_ENTERはありません。^^;

	VK_MENU	多くの日本語キーボードでは「Alt」キー、PC98では「Graph」キーとか呼ばれてるものです。
		Alt+F4やアプリケーションのメニュー、ウィンドウの最大化最小化などで使います。
		間違ってVK_ALTと書いても動きません。

	VK_LWIN	単独で押すとスタートメニューが出るあのキーですが何気にLとRがあります。
	VK_RWIN	上記のR。そしてVK_WINは存在しません。
		WIN単体、WIN+Mで全窓最小化、WIN+Rでファイル名を指定して実行ボックスなどなどで使用。

	　また、一部のキーボード、特にNECやFUJITSUなどのパソコンで「メールキー」やら「再生・停止」
	やら「ボリュームダウン」、「次のトラックへ」などのようなキーがあるものがありますが、実は
	これらのキーはメーカー独自仕様ではなく、なにげに標準規格の準拠したキーです。ゆえに、キーボ
	ードにそういったキーがあろうがなかろうがスマートスクロールから使用することは可能です。

	VK_BROWSER_BACK		ブラウザ・戻る
	VK_BROWSER_FORWARD	ブラウザ・進む
	VK_BROWSER_REFRESH	ブラウザ・更新
	VK_BROWSER_STOP		ブラウザ・読み込みを停止
	VK_BROWSER_SEARCH	ブラウザ・検索する
	VK_BROWSER_FAVORITES	ブラウザ・お気に入りを表示する
	VK_BROWSER_HOME		ブラウザ・ホームページを開く

	VK_VOLUME_MUTE	音量・ミュート
	VK_VOLUME_DOWN	音量・下げる
	VK_VOLUME_UP	音量・上げる

	VK_MEDIA_NEXT_TRACK	次のトラックへ
	VK_MEDIA_PREV_TRACK	前のトラックへ
	VK_MEDIA_STOP		停止
	VK_MEDIA_PLAY_PAUSE	再生と一時停止

	VK_LAUNCH_MAIL		メールソフトを起動
	VK_LAUNCH_MEDIA_SELECT	メディアプレーヤーを起動
	VK_LAUNCH_APP1		ユーザー指定のアプリその一を起動
	VK_LAUNCH_APP2		ユーザー指定のアプリその一を起動

	　・・・と、いってもWindows95じゃ動かないでしょうけどネ。^^;WindowsXPやこれらのキーコード
	にちゃんと(?)対応してるアプリだと使えます。

	　仮想キーコードについては、「http://www.google.com/search?num=50&lr=lang_ja&q=仮想キーコード」
	などとして目的のキーの正しいスペリングを調べつつ設定を作るとよいでしょう。

	　で、ようやく設定の例です。^^;

	ex)	SSPB1=VK_CONTROL VK_A
	ex)	SSPB2=VK_CONTROL VK_C
	ex)	SSPB3=VK_CONTROL VK_X
	ex)	SSPB4=VK_CONTROL VK_V
	ex)	SSPB5=VK_MENU VK_SPACE VK_X
	ex)	SSPB6=VK_MENU VK_SPACE VK_N
	ex)	SSPB7=VK_MENU VK_F VK_A
	ex)	SSPB8=VK_MENU VK_H VK_A
	ex)	SSPSU=VK_SSP_DEFAULT
	ex)	SSPSD=VK_SSP_DEFAULT
	ex)	SSPSL=VK_SSP_HSL
	ex)	SSPSR=VK_SSP_HSR
	ex)	SSPZF=VK_SSP_VSU
	ex)	SSPZB=VK_SSP_VSD
	ex)	SSPZC=VK_SSP_SHOW_HIDE

	　設定は例のように「キーを押す順番にキーとキーの間は半角スペースで区切って記述」します。
	押したキーを離す処理は万能文化プラグインが自動的に行いますので押す順序だけ考えて下さい。

	　なお、キーボードは順番にキーを押していき、最後のキーまで押したら押したのとは逆の順序
	にキーを離す、という処理が行われます。SSPBTでIを指定した項目の場合も押される順序や、キー
	を離す処理が自動的に行われることは同じです。

	　ボタン１は「Ctrl+A」ですから対象アプリがメモ帖なら”すべて選択”、以下同様にメモ帖なら

	「CONTROLを押してCを押す(その後自動的にCが離されCONTROLが離される)」＝「Ctrl+C」⇒コピー
	「CONTROL+X」⇒切り取り
	「CONTROL+V」⇒貼り付け

	　さて、「ALT+SPACE+X」とはなんだと思われるかもしれませんが、「ALT+SPACE」で通常はウィン
	ドウ本体に関するメニューが開くことになっています。メモ帖で一度この動作をやってみると理解
	できると思います。(キーマニじゃないと知らんかな^^;)そういうわけで+Xで最大化、+Nは最小化
	という動作をします。

	　次にボタン7、8についてですが「ALT+F+A」？そんなショートカットメモ帖に・・・実はありま
	す。ためしにメモ帖を起動してALT+F+Aとゆっくり順番に押してみましょう。「名前を付けて保存
	」が出れば正しく押せています。同様にALT+H+Aではバージョン情報がでるハズです。
	　これは、ALTがウィンドウにくっついている標準のメニューを、Fが「ファイル(F)」、そして、
	開かれたファイルメニューの項目には「名前を付けて保存(A)」があります。メニューには大抵の
	場合このようにキーだけでメニューの操作が可能なようにメニュー項目ごとにキーが設定されて
	おり、一部の特例的な「CTRL+C:コピー」などのような設定が無くてもメニュー操作ができるよう
	に工夫されています。

	　さて、ボタンについてはいいとして、スクロールのUDLR(上下左右)やズームに仮想キーコード
	としては見たことのない(ハズ)の文字列が指定されています。これは万能文化プラグインが仮想
	キーコードにないコードを勝手に決めたものです。以下のコードを定義しました。

	VK_SSP_DEFAULT	標準処理を行う。これが設定されていない項目は標準処理が行われません。
			たとえば何も設定しないでもDefaultプラグインでズーム機能がSSのズーム
			で動くようなアプリの場合に、万能文化プラグインを使った場合、何も指定
			しないままではズームが行われなくなります。以下のようにして使用できます。

			ex)	SSPZF=VK_CONTROL VK_A SSP_DEFAULT

			この例ではズームホイールを前回転した場合CTRL+Aを行い、さらにズーム処理
			も行うとになります。SSP_DEFAULTの記述は最初でも最後でも途中でも構いませ
			ん。勿論、SSP_DEFAULT単独で指定しても構いません。ズームホイールやスクロ
			ールボールで有効です。

	VK_SSP_SHOW_HIDE	デファルトプラグインなどでズームホイールボタンに標準で割り当て
				られていることが多い「SmartScrollウィンドウの表示/非表示」です。
				これまた指定位置は何番目でも、単独指定でも構いません。
				※ちなみにズームホイールボタンにVK_SSP_DEFAULTを指定してもこの
				　機能を指定したことにはなりません。

	VK_SSP_VSU	垂直スクロールにアップ命令を送ります。
	VK_SSP_VSD	垂直スクロールにダウン命令を送ります。
	VK_SSP_HSL	水平スクロールにレフト命令を送ります。
	VK_SSP_HSR	水平スクロールにライト命令を送ります。

			これらのスクロール命令はすべて「１ラインスクロールしろ」という命令を
			出してはいますが、環境によってはSSPSU/SSPSDにVK_DEFAULTのみを指定した
			場合とスクロール量が違うこともあります。

　　設定は以上です。そんなに難しい記述ではないのですが覚えられましたか？サンプルの設定ファイルを
　見ながら設定してみてください。



●使用許諾

・本ソフトウェアはフリーソフトです。個人、業務に関わらず自由に使用して構いません。
・先の配布ファイル構成が改変されずに含まれる形であれば、自由に複製し、頒布して構いません。
・本ソフトウェアに対しては、いかなる保証もおこないません。

●作者情報

☆ハンドルネーム
　♪不思議うさぎ

☆オフィシャルサイト『♪不思議うさぎ．ｎｅｔ』
　http://www.fushigiusagi.net

☆電子摺り合うも何かの縁
　mailto:paris@rose.freemail.ne.jp

※SmartScrollはWACOM社の登録商標です。

　WACOM社のホームページ
　　http://www.wacom.co.jp

